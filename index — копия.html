<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OTS</title>
  <link rel="icon" href="https://picsum.photos/32/32?random=99" type="image/png" />
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Custom Font and Global Styles -->
  <style>
    @font-face {
      font-family: 'MarkinLT';
      src: url('MarkinLT-UltraBold.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }
    body {
      font-family: 'MarkinLT', sans-serif;
      background-color: #000;
      color: white;
      margin: 0;
      padding: 0;
      height: 100vh;
      width: 100vw;
      overflow: hidden; /* Prevent scrolling due to skewed elements on desktop */
    }
    /* Utility class for text shadow, not directly available in Tailwind CDN */
    .text-shadow-lg {
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }
  </style>
  <script type="importmap">
    {
      "imports": {
        "react": "https://aistudiocdn.com/react@^19.2.0/index.js",
        "react/jsx-runtime": "https://aistudiocdn.com/react@^19.2.0/jsx-runtime.js",
        "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.0/client.js"
      }
    }
  </script>
</head>
<body>
  <div id="root"></div>

  <script type="module">
    import React from 'react';
    import ReactDOM from 'react-dom/client';

    // Type definition for Project (conceptual, not actual TypeScript)
    // interface Project {
    //   id: string;
    //   title: string;
    //   imageUrl: string;
    //   logoUrl: string;
    //   link: string;
    //   backgroundColor: string;
    // }

    const ProjectCard = ({
      project,
      isHovered,
      onMouseEnter,
      onMouseLeave,
      flexGrowValue,
    }) => {
      const [imgTranslateX, setImgTranslateX] = React.useState(0);
      const [imgTranslateY, setImgTranslateY] = React.useState(0);
      const parallaxIntensity = 15; // Max pixels to move

      const handleCardClick = () => {
        window.location.href = project.link;
      };

      const handleMouseMove = React.useCallback((e) => {
        const cardRect = e.currentTarget.getBoundingClientRect();
        const mouseX = e.clientX - cardRect.left;
        const mouseY = e.clientY - cardRect.top;

        const centerX = cardRect.width / 2;
        const centerY = cardRect.height / 2;

        const diffX = (mouseX - centerX) / centerX; // -1 to 1
        const diffY = (mouseY - centerY) / centerY; // -1 to 1

        setImgTranslateX(-diffX * parallaxIntensity); // Move opposite to mouse
        setImgTranslateY(-diffY * parallaxIntensity); // Move opposite to mouse
      }, []);

      const handleMouseLeaveAndReset = React.useCallback(() => {
        setImgTranslateX(0);
        setImgTranslateY(0);
        onMouseLeave(); // Call original onMouseLeave prop
      }, [onMouseLeave]);

      return React.createElement(
        'div',
        {
          className: `relative h-full flex flex-col overflow-hidden 
                      transition-all duration-300 ease-in-out cursor-pointer group`,
          style: {
            flexGrow: flexGrowValue,
            backgroundColor: project.backgroundColor,
            // The ProjectCard itself will inherit the skew from ProjectContainer
            // Its origin is important for how flex-grow affects the skewed shape
            transformOrigin: 'bottom left', 
          },
          onMouseEnter: onMouseEnter,
          onMouseLeave: handleMouseLeaveAndReset, // Use the new reset handler
          onMouseMove: isHovered ? handleMouseMove : null, // Only track mouse when hovered
          onClick: handleCardClick,
        },
        // Inner wrapper to counter-skew content, making it appear straight
        React.createElement(
          'div',
          { 
            className: `absolute inset-0 w-full h-full flex flex-col items-center justify-end p-4 text-center 
                        md:transform md:skew-x-[8deg]`, /* Counter-skew on desktop to make content straight */
            style: { 
              transformOrigin: 'bottom left', /* Match container's transform origin for effective counter-skew */
            }
          },
          // Background Image - applies counter-skew, scales on hover, and parallax
          React.createElement(
            'img',
            {
              src: project.imageUrl,
              alt: project.title,
              className: `absolute inset-0 w-full h-full object-cover transition-transform duration-300 ease-in-out`,
              style: {
                transformOrigin: 'center center', /* Image scales from its center */
                // Base scale (1.15) to ensure it always overfills, plus parallax and hover scale
                transform: `translate3d(${imgTranslateX}px, ${imgTranslateY}px, 0) ${isHovered ? 'scale(1.7)' : 'scale(1.7)'}`,
              },
            }
          ),
          // Content (Logo and Title) - always visible, title appears on hover
          React.createElement(
            'div',
            { className: "relative z-10 flex flex-col items-center justify-end h-full w-full" },
            React.createElement(
              'img',
              {
                src: project.logoUrl,
                alt: `Логотип ${project.title}`,
                className: `h-auto object-contain transition-transform duration-300 group-hover:scale-105 
                            mb-8 md:mb-12 max-w-[min(250px,80%)]`, /* Responsive logo size */
              }
            ),
            React.createElement(
              'h2',
              { className: "absolute bottom-4 md:bottom-8 text-3xl md:text-5xl font-extrabold text-white text-shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap" },
              project.title
            )
          )
        )
      );
    };

    const ProjectContainer = ({ projects }) => {
      const [hoveredProjectId, setHoveredProjectId] = React.useState(null);

      const handleMouseEnter = React.useCallback((id) => {
        setHoveredProjectId(id);
      }, []);

      const handleMouseLeave = React.useCallback(() => {
        setHoveredProjectId(null);
      }, []);

      const defaultGrow = 1;
      const hoverGrow = 2; // When a card is hovered, it receives twice the flex-grow factor

      // Calculate the necessary width and margin-left to offset the skew effect
      // and cover the entire viewport without gaps.
      const skewAngleRad = -8 * Math.PI / 180; // Convert skew angle to radians
      const viewportHeight = typeof window !== 'undefined' ? window.innerHeight : 0;
      const horizontalShift = viewportHeight * Math.tan(Math.abs(skewAngleRad));

      return React.createElement(
        'div',
        {
          className: `flex flex-col md:flex-row h-full w-full overflow-hidden 
                      transition-transform duration-300 ease-in-out 
                      md:transform md:skew-x-[-8deg]`, /* Apply global skew on medium screens and up */
          style: {
            transformOrigin: 'bottom left', /* Consistent transform origin */
            // Adjust width and margin-left to compensate for the skew
            width: `calc(100% + ${horizontalShift}px)`,
            marginLeft: `-${horizontalShift}px`,
          }
        },
        projects.map((project) =>
          React.createElement(ProjectCard, {
            key: project.id,
            project: project,
            isHovered: hoveredProjectId === project.id,
            onMouseEnter: () => handleMouseEnter(project.id),
            onMouseLeave: handleMouseLeave,
            flexGrowValue: hoveredProjectId === project.id ? hoverGrow : defaultGrow,
          })
        )
      );
    };

    // Placeholder project data
    const projects = [
      {
        id: 'p5x',
        title: '',
        imageUrl: 'p5x.png',
        logoUrl: 'P5XLG.png',
        link: 'p5x.html',
        backgroundColor: '#4CAF50',
      },
      {
        id: 'pq2',
        title: '',
        imageUrl: 'pq2.jpg',
        logoUrl: 'PQ2_logo.png',
        link: 'pq2.html',
        backgroundColor: '#f44336',
      },
      {
        id: 'RC',
        title: '',
        imageUrl: 'rcbg.jpg',
        logoUrl: 'RC.png',
        link: 'RC.html',
        backgroundColor: '#3498db',
      },
      {
        id: 'HL',
        title: '',
        imageUrl: 'hlbg.jpg',
        logoUrl: 'logo_en.png',
        link: 'HL.html',
        backgroundColor: '#ffc107',
      },
    ];

    const App = () => {
      return React.createElement(
        'div',
        {
          className: "h-screen w-screen bg-black",
        },
        React.createElement(ProjectContainer, { projects: projects })
      );
    };

    const rootElement = document.getElementById('root');
    if (!rootElement) {
      throw new Error("Could not find root element to mount the React application.");
    }

    const root = ReactDOM.createRoot(rootElement);
    root.render(
      React.createElement(React.StrictMode, null, React.createElement(App, null))
    );
  </script>
</body>
</html>